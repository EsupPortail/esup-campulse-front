<VirtualHost *:80>
    ServerName campulse-demo.unistra.fr

    RewriteEngine On
    RewriteCond %{HTTPS}  !=on
    RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R,L]
</VirtualHost>

<VirtualHost *:443>
    ServerName campulse-demo.unistra.fr
    ServerAdmin support@unistra.fr

    SSLEngine On

    SSLCertificateFile /etc/ssl/certs/mega_wildcard.pem
    SSLCertificateKeyFile /etc/ssl/private/mega_wildcard.key
    SSLCertificateChainFile /etc/ssl/certs/mega_wildcard.chcrt

    LogLevel warn
    ErrorLog /var/log/apache2/campulse-demo.unistra.fr-error.log
    CustomLog /var/log/apache2/campulse-demo.unistra.fr-access.log combined

    DocumentRoot /var/www/static/campulse-demo

    Header set Access-Control-Allow-Origin "*"
    Header set Referrer-Policy "same-origin"
    Header set Strict-Transport-Security "max-age=63072000"
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "DENY"

    Define DEFAULT_SRC "'none'"
    Define BASE_URI "'self'"
    Define CONNECT_SRC "'self' https://campulse-api-demo.unistra.fr https://sentry.app.unistra.fr https://webomat.unistra.fr"
    Define FONT_SRC "'self'"
    Define FRAME_ANCESTORS "'none'"
    Define FRAME_SRC "'none'"
    Define IMG_SRC "'self' data: https://s3.unistra.fr https://webomat.unistra.fr"
    Define MANIFEST_SRC "'self'"
    Define MEDIA_SRC "'self'"
    define OBJECT_SRC "'none'"
    Define SCRIPT_SRC "'self' https://webomat.unistra.fr"
    Define STYLE_SRC "'self'"
    Define WORKER_SRC "'self'"

    <Proxy *>
        AddDefaultCharset off
        Order deny,allow
        Allow from all
    </Proxy>

    ProxyVia off
    ProxyTimeout 600
    ProxyRequests off
    ProxyPreserveHost On
</VirtualHost>